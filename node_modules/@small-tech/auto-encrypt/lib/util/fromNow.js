import { Temporal } from 'temporal-polyfill'

/**
  Helper to get “from now” string (e.g., “in 3 days” or “2 months ago”)

  @param {Temporal.Instant} instant
  @returns {string}
*/
export default function fromNow (instant) {
  const now = Temporal.Now.instant()
  const duration = instant.since(now)
  const rtf = new Intl.RelativeTimeFormat('en', { numeric: 'auto' })

  const seconds = duration.total({ unit: 'seconds' })
  const absSeconds = Math.abs(seconds)

  if (absSeconds < 60 * 60 * 23.5) {
    const hours = Math.round(seconds / (60 * 60))
    return rtf.format(hours, 'hour')
  } else if (absSeconds < 60 * 60 * 24 * 29.5) {
    const days = Math.round(seconds / (60 * 60 * 24))
    return rtf.format(days, 'day')
  } else {
    const months = Math.round(seconds / (60 * 60 * 24 * 30))
    return rtf.format(months, 'month')
  }
}
